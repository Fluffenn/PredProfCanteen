{% extends "base.html" %}
{% block content %}
<div class="card">
    <div class="card-header">
        <h2>üçΩÔ∏è –ú–µ–Ω—é –Ω–∞ {{ today }}</h2>
    </div>

    {% if allergen_warnings or preference_matches %}
        <div style="background: #fff5f5; border-left: 4px solid #e53e3e; padding: 12px; margin-bottom: 15px; border-radius: 0 8px 8px 0;">
            {% if allergen_warnings %}
                <strong>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ!</strong> –£ –≤–∞—Å –µ—Å—Ç—å –∞–ª–ª–µ—Ä–≥–∏—è –Ω–∞: <em>{{ allergies_list }}</em>.
            {% endif %}
            {% if preference_matches %}
                <br><strong>‚ù§Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º!</strong> –ï—Å—Ç—å –±–ª—é–¥–∞ —Å –≤–∞—à–∏–º–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è–º–∏: <em>{{ preferences_list }}</em>.
            {% endif %}
        </div>
    {% endif %}

    {% if menu_set %}
        <!-- –ó–∞–≤—Ç—Ä–∞–∫ -->
        <div class="meal-card">
            <h3>üïó –ó–∞–≤—Ç—Ä–∞–∫ ‚Äî {{ "%.2f"|format(breakfast_price) }} ‚ÇΩ</h3>

            {% set breakfast_dishes = [menu_set.breakfast_main, menu_set.breakfast_drink] %}
            {% for dish in breakfast_dishes %}
                <p>
                    {% if dish %}
                        {{ dish }}
                        {% if allergen_warnings.get(dish) %}
                            <span style="color: #e53e3e; font-weight: bold;"> ‚ö†Ô∏è</span>
                        {% endif %}
                        {% if preference_matches.get(dish) %}
                            <span style="color: #dd6b20; font-weight: bold;"> ‚ù§Ô∏è</span>
                        {% endif %}
                    {% endif %}
                </p>
            {% endfor %}

            <div class="meal-actions">
                {% if 'breakfast' not in taken_types %}
                    <a href="{{ url_for('student_get_meal', meal_type='breakfast') }}" class="btn btn-success">–ü–æ–ª—É—á–∏—Ç—å –∑–∞–≤—Ç—Ä–∞–∫</a>
                {% else %}
                    <span class="btn btn-disabled">‚úÖ –ü–æ–ª—É—á–µ–Ω–æ</span>
                {% endif %}
            </div>
        </div>

        <!-- –û–±–µ–¥ -->
        <div class="meal-card">
            <h3>üïê –û–±–µ–¥ ‚Äî {{ "%.2f"|format(lunch_price) }} ‚ÇΩ</h3>

            {% set lunch_dishes = [menu_set.lunch_first, menu_set.lunch_second, menu_set.lunch_drink] %}
            {% for dish in lunch_dishes %}
                <p>
                    {% if dish %}
                        {{ dish }}
                        {% if allergen_warnings.get(dish) %}
                            <span style="color: #e53e3e; font-weight: bold;"> ‚ö†Ô∏è</span>
                        {% endif %}
                        {% if preference_matches.get(dish) %}
                            <span style="color: #dd6b20; font-weight: bold;"> ‚ù§Ô∏è</span>
                        {% endif %}
                    {% endif %}
                </p>
            {% endfor %}

            <div class="meal-actions">
                {% if 'lunch' not in taken_types %}
                    <a href="{{ url_for('student_get_meal', meal_type='lunch') }}" class="btn btn-success">–ü–æ–ª—É—á–∏—Ç—å –æ–±–µ–¥</a>
                {% else %}
                    <span class="btn btn-disabled">‚úÖ –ü–æ–ª—É—á–µ–Ω–æ</span>
                {% endif %}
            </div>
        </div>
    {% else %}
        <div class="card" style="background: #fff5f5; border-left: 4px solid #e53e3e;">
            <p>‚ùå –ú–µ–Ω—é –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –Ω–µ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–æ.</p>
        </div>
    {% endif %}
</div>
{% endblock %}