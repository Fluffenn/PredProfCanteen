{% extends "base.html" %}
{% block content %}
<div class="card">
    <div class="card-header">
        <h2>üÜï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –±–ª—é–¥–æ</h2>
    </div>

    <form method="POST">
        <label>–ù–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞:</label>
        <input type="text" name="dish_name" required placeholder="–û–º–ª–µ—Ç">

        <label>–¶–µ–Ω–∞ (‚ÇΩ):</label>
        <input type="number" name="price" step="0.01" min="0.01" required placeholder="50.00">

        <h3 style="margin: 20px 0 10px;">–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã:</h3>
        <div id="ingredients">
            <div class="ingredient-row" style="display: flex; gap: 10px; margin-bottom: 10px; align-items: end;">
                <select name="ingredient[]" style="flex: 2;">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–¥—É–∫—Ç</option>
                    {% for item in inventory %}
                        <option value="{{ item.product_name }}">{{ item.product_name }}</option>
                    {% endfor %}
                </select>
                <input type="number" name="quantity[]" step="0.01" min="0.01" placeholder="–ö–æ–ª-–≤–æ" style="flex: 1;" required>
                <input type="text" name="unit[]" placeholder="–ï–¥. –∏–∑–º." value="—à—Ç" style="flex: 1;" required>
                <button type="button" onclick="removeIngredient(this)" style="background: #e53e3e; color: white; border: none; width: 30px; height: 30px; border-radius: 4px;">‚àí</button>
            </div>
        </div>

        <button type="button" onclick="addIngredient()" style="margin: 10px 0; background: #48bb78; color: white; border: none; padding: 8px 16px; border-radius: 4px;">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç</button>
        <br>
        <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –±–ª—é–¥–æ</button>
    </form>
</div>

<script>
function addIngredient() {
    const container = document.getElementById('ingredients');
    const newRow = document.createElement('div');
    newRow.className = 'ingredient-row';
    newRow.style.display = 'flex';
    newRow.style.gap = '10px';
    newRow.style.marginBottom = '10px';
    newRow.style.alignItems = 'end';
    newRow.innerHTML = `
        <select name="ingredient[]" style="flex: 2;">
            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–¥—É–∫—Ç</option>
            {% for item in inventory %}
                <option value="{{ item.product_name }}">{{ item.product_name }}</option>
            {% endfor %}
        </select>
        <input type="number" name="quantity[]" step="0.01" min="0.01" placeholder="–ö–æ–ª-–≤–æ" style="flex: 1;" required>
        <input type="text" name="unit[]" placeholder="–ï–¥. –∏–∑–º." value="—à—Ç" style="flex: 1;" required>
        <button type="button" onclick="removeIngredient(this)" style="background: #e53e3e; color: white; border: none; width: 30px; height: 30px; border-radius: 4px;">‚àí</button>
    `;
    container.appendChild(newRow);
}

function removeIngredient(button) {
    button.closest('.ingredient-row').remove();
}
</script>
{% endblock %}